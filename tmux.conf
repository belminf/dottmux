# Change prefix
unbind-key C-b
set-option -g prefix C-Space

# Theme
set -g @plugin 'catppuccin/tmux#v2.1.3'
set -g @catppuccin_flavor 'mocha'
set -g @catppuccin_window_text " #W"
set -g @catppuccin_window_current_text " #W"
set -g @catppuccin_window_flags "icon"
set -g @catppuccin_window_current_number_color "#{@thm_yellow}"
set -g @catppuccin_window_flags_icon_format "##{?window_activity_flag,#{E:@catppuccin_window_flags_icon_activity},}##{?window_bell_flag,#{E:@catppuccin_window_flags_icon_bell},}##{?window_zoomed_flag,#{E:@catppuccin_window_flags_icon_zoom},}"

set-option -g default-terminal "screen-256color"
set-option -g status-position top

set -g window-style 'fg=colour247,bg=colour233'
set -g window-active-style 'fg=colour250,bg=black'

set -g status-justify "absolute-centre"
set -g status-right "#[fg=#{@thm_lavender},bg=#{@thm_surface_0}] #(TZ='America/Los_Angeles' date +'%%H:%%M %%Z') #[fg=#{@thm_lavender},bg=#{@thm_surface_1}] #(date -u +'%%H:%%M %%Z') #[default]"

# Status left
set -g @monitor_prefix "#[fg=#{@thm_lavender},bg=#{@thm_surface_0}] "
set -g @monitor_separator " #[default] #[fg=#{@thm_lavender},bg=#{@thm_surface_0}] "
set -g @monitor_suffix " #[default]"
set -g status-left "#(~/.tmux/run_monitors.sh)"
set -g status-left-length 100

# Indexing
set-option -g base-index 1
set-option -g renumber-windows on

# Manually handle naming
set-window-option -g automatic-rename off
set-window-option -g allow-rename off
bind-key . command-prompt -I "#W" -p "rename:" "rename-window -- '%%'"
bind-key , command-prompt -p "move to:" "move-window -r -t '%%'"

# Change tooltip display
set-option -g display-time 750

# Do not detach if session is destroyed
set-option -g detach-on-destroy off

# Modify delay for escape key
## Ref: https://github.com/neovim/neovim/wiki/FAQ#esc-in-tmux-or-gnu-screen-is-delayed
set-option -sg escape-time 1

# Synchronize panes
bind-key S set-window-option synchronize-panes

# Move pains
bind-key X command-prompt -p "window to join:"  "join-pane -t '%%'"
bind-key B break-pane

# Clipboard
set-window-option -g mode-keys vi

# Alerting
set-option -g visual-bell off
setw -g monitor-activity on

# Mouse
set-option -g mouse on

# Plugins
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'tmux-plugins/tmux-sensible'

set -g @plugin 'belminf/tmux-pain-control'
set -g @pane_new_window_binding "no"
bind-key c command-prompt -p "window name:" "new-window; rename-window '%%'"
bind-key C command-prompt -p "window name:" "new-window; rename-window '%%'"

set -g @plugin 'tmux-plugins/tmux-yank'
set -g @yank_selection_mouse 'clipboard'
set -g @yank_action 'copy-pipe-and-cancel'
bind-key -T copy-mode-vi Escape send-keys -X cancel
bind-key -n MouseDown2Pane run "xclip -o -sel clipboard | tmux load-buffer -; tmux paste-buffer"
bind-key v copy-mode
bind-key p paste-buffer

# macOS specific
if-shell 'test "$(uname)" = "Darwin"' 'source ~/.tmux/macos.conf'

# Init TPM
run -b '~/.tmux/plugins/tpm/tpm'
